How to force peering on a placement group?
##########################################
:date: 2017-02-11 17:59
:author: arvimal
:category: Ceph
:tags: ceph, osd, peering, placement groups
:slug: 647
:status: draft

**P**\ eering is the process

**T**\ here can be certain scenarios where the OSDs in a Placement Group doesn't peer properly, or if the peering is stuck indefinitely.

For example, a case where the OSDs of a node goes down and get marked out. Usually, a ``pg_temp`` list would be created as a new mapping. Sometimes, the pg_temp values may not get cleared even if the OSDs that were marked down comes back.

In such a case, marking the primary OSD down of the PG in question is a way to force peering to start again. Marking an OSD ``down`` will bring the OSD down but will immediately force it up since Ceph tries to heal the system automatically.

Once the OSD comes up, a peering process is kicked in automatically which would assign the proper OSDs back, and eventually remove the ``pg_temp`` list.

A ``ceph pg dump | grep <pg.num>`` on any of the PGs which had a ``pg_temp`` value earlier should show the new set of OSDs properly.

This procedure can also be helpful if all the OSDs are up/in but some of the PGs are stuck as ``inactive``. This means that the PGs cannot service read/write requests until it gets back to an ``active`` state.

 
